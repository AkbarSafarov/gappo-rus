"use strict";function _createForOfIteratorHelper(e,t){var o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!o){if(Array.isArray(e)||(o=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,l=!1;return{s:function(){o=o.call(e)},n:function(){var e=o.next();return i=e.done,e},e:function(e){l=!0,a=e},f:function(){try{i||null==o.return||o.return()}finally{if(l)throw a}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var o={}.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,r=Array(t);o<t;o++)r[o]=e[o];return r}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function setCookie(e,t,o){var r=new Date;return r.setTime(r.getTime()+o),document.cookie="".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(t),";expires=").concat(r.toUTCString(),";path=/"),console.log("cookie ".concat(e," ").concat(t," - added"))}function getCookie(e){var t=document.cookie.match(new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)"));return t?decodeURIComponent(t[1]):null}function deleteCookie(e){return document.cookie="".concat(encodeURIComponent(e),"=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/"),console.log("cookie ".concat(e," - deleted"))}function FormHandler(e){this.form=e,this.error={message:"Непредвиденная ошибка",status:"error"},this.loader=null,"undefined"!=typeof Loader&&(this.loader=new Loader),"undefined"!=typeof FormValidator&&(this.validator=new FormValidator({texts:{invalid:"Неправильное значение",short:"Введите больше символов",long:"Введите меньше символов",checked:"Должно быть отмечено",empty:"Это поле пустое",select:"Пожалуйста, выберите опцию",number_min:"Слишком маленькое значение",number_max:"Слишком высокое значение",url:"Недействительный URL",number:"Не является числом",email:"Некорректный E-mail",no_match:"Нет совпадения",complete:"Ввод не завершен"},classes:{item:"ui-ctl",alert:"ui-ctl-tag ui-ctl-tag-danger",bad:"ui-ctl-danger"},events:["blur"]}),this.init())}FormHandler.prototype.init=function(){var e=this;this.form.addEventListener("blur",function(t){e.validator.checkField(t.target)},!0),this.form.onsubmit=function(t){t.preventDefault(),e.handleSubmit(t)}},FormHandler.prototype.handleSubmit=function(e){var t=this;this.form.submitter=e.submitter;var o,r=this.validator.checkAll(this.form),n=this.form.getAttribute("action"),a=new FormData(this.form);r.valid&&n&&(this.form.submitter.disabled=!0,this.form.submitter.style.display="none","undefined"!=typeof Loader&&(null===(o=this.loader)||void 0===o||o.type()),fetch(n,{headers:{"X-Requested-With":"XMLHttpRequest"},method:"POST",body:a}).then(function(e){var o;if("undefined"!=typeof Loader&&(null===(o=t.loader)||void 0===o||o.type("close")),!e.ok)throw new Error("Ответ сети не соответствует ожиданиям");return e.json()}).then(function(e){var o;"undefined"!=typeof Loader&&(null===(o=t.loader)||void 0===o||o.type("close")),t.handleResponse(e)}).catch(function(e){var o;"undefined"!=typeof Loader&&(null===(o=t.loader)||void 0===o||o.type("close")),t.handleResponse(t.error,e)}))},FormHandler.prototype.handleResponse=function(e){var t=this,o=(arguments.length>1&&void 0!==arguments[1]&&arguments[1]," alert-danger"),r="Произошла ошибка!",n=!1;"object"===_typeof(e)&&"error"!==e.status&&(this.form.reset(),o=" alert-success",r="Заявка отправлена!",n=!0);var a=document.createElement("div");a.className="alert"+o,a.innerHTML='<span class="small"><strong>'+r+"</strong> "+(e.message||"Непредвиденная ошибка")+"</span>";var i=this.form.querySelector("[data-alert-insert]");i?i.insertAdjacentElement("afterend",a):this.form.append(a),setTimeout(function(){t.form.submitter.disabled=!1,t.form.submitter.style.display="",a.remove(),n&&Fancybox.close()},5e3)},document.addEventListener("DOMContentLoaded",function(){setTimeout(function(){var e,t=_createForOfIteratorHelper(document.forms);try{for(t.s();!(e=t.n()).done;){var o=e.value;o.noValidate&&new FormHandler(o)}}catch(e){t.e(e)}finally{t.f()}},100)});